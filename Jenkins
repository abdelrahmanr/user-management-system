pipeline {
  agent any

  environment {
    REPO_URL = 'https://github.com/abdelrahmanr/user-management-system.git'
  }

  stages {

    stage('Checkout') {
      steps {
        echo "Cloning public repository..."
        git branch: "${env.BRANCH_NAME}", url: "${env.REPO_URL}"
      }
    }

    stage('Build') {
      steps {
        script {
          if (env.BRANCH_NAME == 'dev') {
            echo "ðŸ”§ Building Development branch..."
            sh 'echo "Building dev environment..."'
          } else if (env.BRANCH_NAME == 'main') {
            echo "ðŸš€ Building Production branch..."
            sh 'echo "Building main environment..."'
          } else {
            echo "Branch ${env.BRANCH_NAME} not handled."
          }
        }
      }
    }

    stage('Test') {
      steps {
        echo "ðŸ§ª Running tests for ${env.BRANCH_NAME}"
        sh 'echo "Tests passed!"'
      }
    }

    stage('Deploy') {
      steps {
        script {
          if (env.BRANCH_NAME == 'main') {
            echo "ðŸš€ Deploying production version..."
            sh 'echo "Deploy complete for main!"'
          } else if (env.BRANCH_NAME == 'dev') {
            echo "ðŸ§ª Deploying dev version..."
            sh 'echo "Deploy complete for dev!"'
          } else {
            echo "Skipping deployment for ${env.BRANCH_NAME}"
          }
        }
      }
    }
  }
}
